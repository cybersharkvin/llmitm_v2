# Code Architecture Overview

## Plugin Architecture

### Abstract Base Classes
- **StepHandler** (`llmitm_v2/handlers/base.py:9`)

### Concrete Implementations
- **ActionGraph** extends `BaseModel` (`llmitm_v2/models/action_graph.py:11`)
- **ApiCallLog** extends `BaseModel` (`llmitm_v2/debug_logger.py:36`)
- **AttackOpportunity** extends `BaseModel` (`llmitm_v2/models/recon.py:21`)
- **AttackPlan** extends `BaseModel` (`llmitm_v2/models/recon.py:44`)
- **ContentBlockSummary** extends `BaseModel` (`llmitm_v2/debug_logger.py:21`)
- **CriticFeedback** extends `BaseModel` (`llmitm_v2/models/critic.py:10`)
- **EventLog** extends `BaseModel` (`llmitm_v2/debug_logger.py:53`)
- **ExecutionContext** extends `BaseModel` (`llmitm_v2/models/context.py:11`)
- **ExecutionResult** extends `BaseModel` (`llmitm_v2/models/context.py:53`)
- **FailureType** extends `str, Enum` (`llmitm_v2/constants.py:26`)
- **Finding** extends `BaseModel` (`llmitm_v2/models/finding.py:9`)
- **Fingerprint** extends `BaseModel` (`llmitm_v2/models/fingerprint.py:9`)
- **HTTPRequestHandler** extends `StepHandler` (`llmitm_v2/handlers/http_request_handler.py:14`)
- **OrchestratorResult** extends `BaseModel` (`llmitm_v2/models/context.py:63`)
- **RegexMatchHandler** extends `StepHandler` (`llmitm_v2/handlers/regex_match_handler.py:10`)
- **RepairDiagnosis** extends `BaseModel` (`llmitm_v2/models/critic.py:21`)
- **RunSummary** extends `BaseModel` (`llmitm_v2/debug_logger.py:61`)
- **Settings** extends `BaseSettings` (`llmitm_v2/config.py:6`)
- **ShellCommandHandler** extends `StepHandler` (`llmitm_v2/handlers/shell_command_handler.py:12`)
- **Step** extends `BaseModel` (`llmitm_v2/models/step.py:10`)
- **StepPhase** extends `str, Enum` (`llmitm_v2/constants.py:6`)
- **StepResult** extends `BaseModel` (`llmitm_v2/models/context.py:32`)
- **StepType** extends `str, Enum` (`llmitm_v2/constants.py:16`)
- **TargetCredentials** extends `BaseModel` (`llmitm_v2/target_profiles.py:12`)
- **TargetProfile** extends `BaseModel` (`llmitm_v2/target_profiles.py:17`)
- **ToolCallRecord** extends `BaseModel` (`llmitm_v2/debug_logger.py:29`)
- **Complete** extends `StepHandler` (`tests/test_handlers.py:51`)
- **Incomplete** extends `StepHandler` (`tests/test_handlers.py:44`)

### Factory Functions
- **create_attack_critic**( model_id: str = "claude-sonnet-4-5-20250929", api_key: Optional[str] = None, ) (`llmitm_v2/orchestrator/agents.py:384`)
- **create_graph_tools**(repo: GraphRepository, embed_model: Optional[Any] = None) (`llmitm_v2/tools/graph_tools.py:124`)
- **create_recon_agent**( mitm_context: str, model_id: str = "claude-sonnet-4-5-20250929", api_key: Optional[str] = None, ) (`llmitm_v2/orchestrator/agents.py:347`)
- **_make**(step_type, command="test", **params) (`tests/test_handlers.py:31`)
- **step_factory**() (`tests/test_handlers.py:30`)

## All Classes
- **ActionGraph** (`llmitm_v2/models/action_graph.py:11`)
- **AgentResult** (`llmitm_v2/orchestrator/agents.py:53`)
- **ApiCallLog** (`llmitm_v2/debug_logger.py:36`)
- **AttackOpportunity** (`llmitm_v2/models/recon.py:21`)
- **AttackPlan** (`llmitm_v2/models/recon.py:44`)
- **ContentBlockSummary** (`llmitm_v2/debug_logger.py:21`)
- **CriticFeedback** (`llmitm_v2/models/critic.py:10`)
- **EventLog** (`llmitm_v2/debug_logger.py:53`)
- **ExecutionContext** (`llmitm_v2/models/context.py:11`)
- **ExecutionResult** (`llmitm_v2/models/context.py:53`)
- **FailureType** (`llmitm_v2/constants.py:26`)
- **Finding** (`llmitm_v2/models/finding.py:9`)
- **Fingerprint** (`llmitm_v2/models/fingerprint.py:9`)
- **Fingerprinter** (`llmitm_v2/fingerprinter.py:9`)
- **GraphRepository** (`llmitm_v2/repository/graph_repository.py:16`)
- **GraphTools** (`llmitm_v2/tools/graph_tools.py:14`)
- **HTTPRequestHandler** (`llmitm_v2/handlers/http_request_handler.py:14`)
- **LLMitMCaptureAddon** (`llmitm_v2/capture/addon.py:12`)
- **Orchestrator** (`llmitm_v2/orchestrator/orchestrator.py:71`)
- **OrchestratorResult** (`llmitm_v2/models/context.py:63`)
- **ProgrammaticAgent** (`llmitm_v2/orchestrator/agents.py:237`)
- **RegexMatchHandler** (`llmitm_v2/handlers/regex_match_handler.py:10`)
- **RepairDiagnosis** (`llmitm_v2/models/critic.py:21`)
- **RunSummary** (`llmitm_v2/debug_logger.py:61`)
- **Settings** (`llmitm_v2/config.py:6`)
- **ShellCommandHandler** (`llmitm_v2/handlers/shell_command_handler.py:12`)
- **SimpleAgent** (`llmitm_v2/orchestrator/agents.py:162`)
- **Step** (`llmitm_v2/models/step.py:10`)
- **StepHandler** (`llmitm_v2/handlers/base.py:9`)
- **StepPhase** (`llmitm_v2/constants.py:6`)
- **StepResult** (`llmitm_v2/models/context.py:32`)
- **StepType** (`llmitm_v2/constants.py:16`)
- **TargetCredentials** (`llmitm_v2/target_profiles.py:12`)
- **TargetProfile** (`llmitm_v2/target_profiles.py:17`)
- **ToolCallRecord** (`llmitm_v2/debug_logger.py:29`)
- **Complete** (`tests/test_handlers.py:51`)
- **Incomplete** (`tests/test_handlers.py:44`)
- **TestActionGraph** (`tests/test_models.py:57`)
- **TestActionGraphModels** (`tests/test_graph_repository.py:58`)
- **TestAgentFactories** (`tests/test_orchestrator.py:126`)
- **TestAttackOpportunity** (`tests/test_recon_models.py:28`)
- **TestAttackPlan** (`tests/test_recon_models.py:51`)
- **TestContextAssembly** (`tests/test_orchestrator.py:62`)
- **TestCriticFeedback** (`tests/test_models.py:92`)
- **TestExecutionContext** (`tests/test_models.py:118`)
- **TestExecutionResult** (`tests/test_orchestrator_main.py:49`)
- **TestFailureClassification** (`tests/test_orchestrator.py:22`)
- **TestFinding** (`tests/test_models.py:79`)
- **TestFingerprint** (`tests/test_models.py:33`)
- **TestGraphRepositoryIntegration** (`tests/test_graph_repository.py:73`)
- **TestGraphTools** (`tests/test_orchestrator.py:93`)
- **TestInterpolateParams** (`tests/test_orchestrator_main.py:89`)
- **TestModelSerialization** (`tests/test_models.py:139`)
- **TestOrchestratorInit** (`tests/test_orchestrator_main.py:80`)
- **TestOrchestratorResult** (`tests/test_orchestrator_main.py:62`)
- **TestRepairDiagnosis** (`tests/test_models.py:104`)
- **TestSkillGuides** (`tests/test_orchestrator.py:147`)
- **TestStep** (`tests/test_models.py:20`)
- **TestStepParametersSerialization** (`tests/test_graph_repository.py:44`)
- **TestStepResult** (`tests/test_models.py:127`)

## All Functions
- **_auth_headers**(profile: TargetProfile, token_ref: str) (`llmitm_v2/tools/exploit_tools.py:69`)
- **_auth_offset**(profile: TargetProfile) (`llmitm_v2/tools/exploit_tools.py:76`)
- **_check_and_log_usage**(model_id: str, usage: Any) (`llmitm_v2/orchestrator/agents.py:32`)
- **_check_budget**() (`llmitm_v2/orchestrator/agents.py:44`)
- **_flow_detail**(flow, body_limit: int = 4000) (`llmitm_v2/tools/recon_tools.py:43`)
- **_flow_summary**(index: int, flow) (`llmitm_v2/tools/recon_tools.py:27`)
- **_increment_id**(path: str) (`llmitm_v2/tools/exploit_tools.py:226`)
- **_login_and_auth_steps**(profile: TargetProfile, user: str = "a") (`llmitm_v2/tools/exploit_tools.py:15`)
- **_print**(msg: str) (`llmitm_v2/repository/setup_schema.py:23`)
- **_read_flows**(mitm_file: str) (`llmitm_v2/tools/recon_tools.py:17`)
- **_safe_json**(body_bytes: bytes | None) (`llmitm_v2/tools/recon_tools.py:66`)
- **_sanitize_content**(content: list) (`llmitm_v2/orchestrator/agents.py:205`)
- **_summarize_content_blocks**(content: list) (`llmitm_v2/debug_logger.py:211`)
- **_truncate_dict**(d: dict, limit: int = _MAX_BLOCK_CHARS) (`llmitm_v2/orchestrator/agents.py:192`)
- **_write_json**(filename: str, model: BaseModel) (`llmitm_v2/debug_logger.py:234`)
- **assemble_recon_context**(mitm_file: str = "", proxy_url: str = "") (`llmitm_v2/orchestrator/context.py:11`)
- **assemble_repair_context**( failed_step: Step, error_log: str, execution_history: list[str], ) (`llmitm_v2/orchestrator/context.py:64`)
- **attack_plan_to_action_graph**(plan: AttackPlan, profile: TargetProfile) (`llmitm_v2/orchestrator/orchestrator.py:43`)
- **auth_strip_steps**(exploit_target: str, observation: str, profile: TargetProfile) (`llmitm_v2/tools/exploit_tools.py:116`)
- **classify_failure**(error_log: str, status_code: int = 0) (`llmitm_v2/orchestrator/failure_classifier.py:6`)
- **create_attack_critic**( model_id: str = "claude-sonnet-4-5-20250929", api_key: Optional[str] = None, ) (`llmitm_v2/orchestrator/agents.py:384`)
- **create_graph_tools**(repo: GraphRepository, embed_model: Optional[Any] = None) (`llmitm_v2/tools/graph_tools.py:124`)
- **create_recon_agent**( mitm_context: str, model_id: str = "claude-sonnet-4-5-20250929", api_key: Optional[str] = None, ) (`llmitm_v2/orchestrator/agents.py:347`)
- **find_similar_action_graphs**(description: str, top_k: int = 5) (`llmitm_v2/tools/graph_tools.py:132`)
- **fingerprint_from_mitm**(mitm_path: str) (`llmitm_v2/capture/launcher.py:59`)
- **get_active_profile**(name: str | None = None) (`llmitm_v2/target_profiles.py:67`)
- **get_handler**(step_type: StepType) (`llmitm_v2/handlers/registry.py:18`)
- **get_repair_history**(fingerprint_hash: str, max_results: int = 10) (`llmitm_v2/tools/graph_tools.py:145`)
- **handle_header_audit**(mitm_file: str) (`llmitm_v2/tools/recon_tools.py:206`)
- **handle_jwt_decode**(mitm_file: str, token_header: str = "Authorization") (`llmitm_v2/tools/recon_tools.py:143`)
- **handle_response_diff**(mitm_file: str, flow_index_a: int, flow_index_b: int) (`llmitm_v2/tools/recon_tools.py:271`)
- **handle_response_inspect**(mitm_file: str, endpoint_filter: str = "") (`llmitm_v2/tools/recon_tools.py:102`)
- **idor_walk_steps**(exploit_target: str, observation: str, profile: TargetProfile) (`llmitm_v2/tools/exploit_tools.py:85`)
- **init_debug_logging**() (`llmitm_v2/debug_logger.py:96`)
- **interpolate_value**(value: object) (`llmitm_v2/orchestrator/orchestrator.py:317`)
- **is_enabled**() (`llmitm_v2/debug_logger.py:111`)
- **load_skill_guides**() (`llmitm_v2/orchestrator/agents.py:58`)
- **log_api_call**( *, agent_type: str, response: object, messages_len: int, cumulative_tokens: int = 0, tool_calls: Optional[list[ToolCallRecord]] = None, ) (`llmitm_v2/debug_logger.py:115`)
- **log_event**(event_type: str, data: dict[str, Any]) (`llmitm_v2/debug_logger.py:157`)
- **main**() (`llmitm_v2/__main__.py:23`)
- **namespace_probe_steps**(exploit_target: str, observation: str, profile: TargetProfile) (`llmitm_v2/tools/exploit_tools.py:174`)
- **quick_fingerprint**(target_url: str) (`llmitm_v2/capture/launcher.py:20`)
- **replacer**(match: re.Match) (`llmitm_v2/orchestrator/orchestrator.py:310`)
- **role_tamper_steps**(exploit_target: str, observation: str, profile: TargetProfile) (`llmitm_v2/tools/exploit_tools.py:201`)
- **set_token_budget**(budget: int) (`llmitm_v2/orchestrator/agents.py:26`)
- **setup_schema**(quiet: bool = False) (`llmitm_v2/repository/setup_schema.py:12`)
- **token_swap_steps**(exploit_target: str, observation: str, profile: TargetProfile) (`llmitm_v2/tools/exploit_tools.py:147`)
- **tx_func**(tx: Session) (`llmitm_v2/repository/graph_repository.py:469`)
- **tx_func**(tx: Session) (`llmitm_v2/repository/graph_repository.py:94`)
- **tx_func**(tx: Session) (`llmitm_v2/repository/graph_repository.py:138`)
- **tx_func**(tx: Session) (`llmitm_v2/repository/graph_repository.py:278`)
- **tx_func**(tx: Session) (`llmitm_v2/repository/graph_repository.py:322`)
- **tx_func**(tx: Session) (`llmitm_v2/repository/graph_repository.py:35`)
- **tx_func**(tx: Session) (`llmitm_v2/repository/graph_repository.py:435`)
- **tx_func**(tx: Session) (`llmitm_v2/repository/graph_repository.py:224`)
- **tx_func**(tx: Session) (`llmitm_v2/repository/graph_repository.py:68`)
- **write_summary**( *, path: Optional[str] = None, compiled: bool = False, repaired: bool = False, success: Optional[bool] = None, steps_executed: int = 0, findings_count: int = 0, ) (`llmitm_v2/debug_logger.py:174`)
- **_make**(step_type, command="test", **params) (`tests/test_handlers.py:31`)
- **api_traffic**() (`tests/test_fingerprinter.py:48`)
- **context**(fingerprint) (`tests/test_handlers.py:25`)
- **dvwa**() (`tests/test_target_profiles.py:26`)
- **express_traffic**() (`tests/test_fingerprinter.py:14`)
- **fingerprint**() (`tests/test_handlers.py:20`)
- **fingerprint**() (`tests/test_orchestrator_main.py:27`)
- **fingerprinter**() (`tests/test_fingerprinter.py:9`)
- **juice**() (`tests/test_target_profiles.py:16`)
- **jwt_traffic**() (`tests/test_fingerprinter.py:26`)
- **nodegoat**() (`tests/test_target_profiles.py:21`)
- **sample_action_graph**() (`tests/test_graph_repository.py:30`)
- **sample_finding**() (`tests/test_graph_repository.py:38`)
- **sample_fingerprint**() (`tests/test_graph_repository.py:23`)
- **sample_opportunity**() (`tests/test_recon_models.py:11`)
- **sample_plan**(sample_opportunity) (`tests/test_recon_models.py:24`)
- **sample_step**() (`tests/test_orchestrator_main.py:37`)
- **step_factory**() (`tests/test_handlers.py:30`)
- **test_all_profiles_have_required_fields**() (`tests/test_target_profiles.py:30`)
- **test_auth_offset_bearer_is_2**(juice) (`tests/test_target_profiles.py:48`)
- **test_auth_offset_cookie_is_1**(nodegoat) (`tests/test_target_profiles.py:52`)
- **test_auth_offset_csrf_is_3**(dvwa) (`tests/test_target_profiles.py:56`)
- **test_auth_strip_cookie_has_skip_cookies_step**(nodegoat) (`tests/test_target_profiles.py:83`)
- **test_bearer_profile_has_extraction_pattern**(juice) (`tests/test_target_profiles.py:35`)
- **test_cookie_profile_has_cookie_name**(nodegoat) (`tests/test_target_profiles.py:39`)
- **test_cookie_steps_lack_authorization_header**(nodegoat) (`tests/test_target_profiles.py:72`)
- **test_execution_context_cookies_default**(fingerprint) (`tests/test_handlers.py:117`)
- **test_fingerprint_extracts_cors_signal**(fingerprinter, express_traffic) (`tests/test_fingerprinter.py:89`)
- **test_fingerprint_extracts_endpoint_pattern**(fingerprinter, api_traffic) (`tests/test_fingerprinter.py:84`)
- **test_fingerprint_extracts_express_tech_stack**(fingerprinter, express_traffic) (`tests/test_fingerprinter.py:74`)
- **test_fingerprint_extracts_jwt_auth**(fingerprinter, jwt_traffic) (`tests/test_fingerprinter.py:79`)
- **test_fingerprint_unknown_when_no_headers**(fingerprinter) (`tests/test_fingerprinter.py:94`)
- **test_get_active_profile_unknown_raises**() (`tests/test_target_profiles.py:43`)
- **test_get_handler_returns_correct_type**() (`tests/test_handlers.py:128`)
- **test_get_handler_unknown_raises**() (`tests/test_handlers.py:132`)
- **test_http_2xx_has_empty_stderr**(step_factory, context) (`tests/test_handlers.py:151`)
- **test_http_4xx_sets_stderr**(fingerprint) (`tests/test_handlers.py:140`)
- **test_http_get_real**(step_factory, context) (`tests/test_handlers.py:161`)
- **test_http_post_with_body**(step_factory, context) (`tests/test_handlers.py:170`)
- **test_idor_capture_bearer_references_last_output**(juice) (`tests/test_target_profiles.py:109`)
- **test_idor_cookie_steps_have_no_auth_offset_issue**(nodegoat) (`tests/test_target_profiles.py:115`)
- **test_idor_csrf_steps_have_no_auth_offset_issue**(dvwa) (`tests/test_target_profiles.py:121`)
- **test_idor_mutate_bearer_references_token_not_login_response**(juice) (`tests/test_target_profiles.py:103`)
- **test_idor_walk_bearer_produces_5_steps**(juice) (`tests/test_target_profiles.py:60`)
- **test_idor_walk_cookie_produces_4_steps**(nodegoat) (`tests/test_target_profiles.py:64`)
- **test_idor_walk_csrf_produces_6_steps**(dvwa) (`tests/test_target_profiles.py:68`)
- **test_login_steps_bearer_produces_2**(juice) (`tests/test_target_profiles.py:89`)
- **test_login_steps_cookie_produces_1**(nodegoat) (`tests/test_target_profiles.py:93`)
- **test_login_steps_csrf_produces_3**(dvwa) (`tests/test_target_profiles.py:97`)
- **test_parse_traffic_log_format**(fingerprinter) (`tests/test_fingerprinter.py:107`)
- **test_regex_capture_group**(step_factory, context) (`tests/test_handlers.py:92`)
- **test_regex_last_output**(step_factory, context) (`tests/test_handlers.py:86`)
- **test_regex_no_match**(step_factory, context) (`tests/test_handlers.py:98`)
- **test_regex_no_outputs**(step_factory, context) (`tests/test_handlers.py:104`)
- **test_regex_source_by_index**(step_factory, context) (`tests/test_handlers.py:109`)
- **test_registry_has_three_types**() (`tests/test_handlers.py:124`)
- **test_shell_echo**(step_factory, context) (`tests/test_handlers.py:59`)
- **test_shell_env_vars**(step_factory, context) (`tests/test_handlers.py:79`)
- **test_shell_exit_code**(step_factory, context) (`tests/test_handlers.py:64`)
- **test_shell_success_criteria**(step_factory, context) (`tests/test_handlers.py:74`)
- **test_shell_timeout**(step_factory, context) (`tests/test_handlers.py:69`)
- **test_step_handler_is_abstract**() (`tests/test_handlers.py:38`)
- **test_step_handler_subclass_requires_execute**() (`tests/test_handlers.py:43`)
- **test_step_handler_subclass_with_execute**() (`tests/test_handlers.py:50`)
- **test_token_swap_raises_for_cookie_auth**(nodegoat) (`tests/test_target_profiles.py:78`)
- **test_token_swap_replay_uses_user_b_token**(juice) (`tests/test_target_profiles.py:127`)

## All Methods
- **__call__**(self, prompt: str, structured_output_model: type = None) (`llmitm_v2/orchestrator/agents.py:171`)
- **__call__**(self, prompt: str, structured_output_model: type = None) (`llmitm_v2/orchestrator/agents.py:265`)
- **__init__**(self) (`llmitm_v2/capture/addon.py:15`)
- **__init__**( self, client: anthropic.Anthropic, system_prompt: str, model_id: str, max_tokens: int, tool_schemas: list[dict], tool_handlers: dict[str, Any], max_iterations: int = 20, ) (`llmitm_v2/orchestrator/agents.py:247`)
- **__init__**(self, client: anthropic.Anthropic, system_prompt: str, model_id: str, max_tokens: int) (`llmitm_v2/orchestrator/agents.py:165`)
- **__init__**(self, graph_repo: GraphRepository, settings: Settings) (`llmitm_v2/orchestrator/orchestrator.py:74`)
- **__init__**(self, driver: Driver) (`llmitm_v2/repository/graph_repository.py:19`)
- **__init__**(self, repo: GraphRepository, embed_model: Optional[Any] = None) (`llmitm_v2/tools/graph_tools.py:17`)
- **_compile**( self, fingerprint: Fingerprint, mitm_file: str = "", proxy_url: str = "", repair_context: str = "", ) (`llmitm_v2/orchestrator/orchestrator.py:122`)
- **_execute**( self, action_graph: ActionGraph, fingerprint: Fingerprint ) (`llmitm_v2/orchestrator/orchestrator.py:191`)
- **_extract_auth_model**(requests: list[dict[str, Any]]) (`llmitm_v2/fingerprinter.py:123`)
- **_extract_endpoint_pattern**(requests: list[dict[str, Any]]) (`llmitm_v2/fingerprinter.py:142`)
- **_extract_security_signals**(responses: list[dict[str, Any]]) (`llmitm_v2/fingerprinter.py:160`)
- **_extract_tech_stack**(responses: list[dict[str, Any]]) (`llmitm_v2/fingerprinter.py:112`)
- **_handle_step_failure**( self, step: Step, result: StepResult, context: ExecutionContext, action_graph: ActionGraph, retried: bool, ) (`llmitm_v2/orchestrator/orchestrator.py:267`)
- **_interpolate_params**(step: Step, context: ExecutionContext) (`llmitm_v2/orchestrator/orchestrator.py:308`)
- **_parse_request**(text: str) (`llmitm_v2/fingerprinter.py:50`)
- **_parse_response**(text: str) (`llmitm_v2/fingerprinter.py:82`)
- **_parse_traffic_log**(traffic_log: str) (`llmitm_v2/fingerprinter.py:29`)
- **_repair**( self, action_graph: ActionGraph, failed_step: Step, error_log: str, execution_history: list[str], fingerprint: Fingerprint, ) (`llmitm_v2/orchestrator/orchestrator.py:330`)
- **_try_warm_start**(self, fingerprint: Fingerprint) (`llmitm_v2/orchestrator/orchestrator.py:115`)
- **_write_flows_to_file**(self) (`llmitm_v2/capture/addon.py:33`)
- **compute_hash**(self) (`llmitm_v2/models/fingerprint.py:32`)
- **done**(self) (`llmitm_v2/capture/addon.py:44`)
- **embed_model**(self) (`llmitm_v2/tools/graph_tools.py:28`)
- **ensure_hash**(self) (`llmitm_v2/models/fingerprint.py:41`)
- **ensure_id**(self) (`llmitm_v2/models/action_graph.py:36`)
- **ensure_id**(self) (`llmitm_v2/models/finding.py:32`)
- **execute**(self, step: Step, context: ExecutionContext) (`llmitm_v2/handlers/base.py:13`)
- **execute**(self, step: Step, context: ExecutionContext) (`llmitm_v2/handlers/http_request_handler.py:17`)
- **execute**(self, step: Step, context: ExecutionContext) (`llmitm_v2/handlers/regex_match_handler.py:13`)
- **execute**(self, step: Step, context: ExecutionContext) (`llmitm_v2/handlers/shell_command_handler.py:15`)
- **find_similar_action_graphs**(self, description: str, top_k: int = 5) (`llmitm_v2/tools/graph_tools.py:36`)
- **find_similar_fingerprints**( self, embedding: List[float], top_k: int = 5, ) (`llmitm_v2/repository/graph_repository.py:79`)
- **fingerprint**(self, traffic_log: str) (`llmitm_v2/fingerprinter.py:12`)
- **get_action_graph_with_steps**( self, fingerprint_hash: str, ) (`llmitm_v2/repository/graph_repository.py:209`)
- **get_fingerprint_by_hash**(self, hash_value: str) (`llmitm_v2/repository/graph_repository.py:58`)
- **get_repair_history**( self, fingerprint_hash: str, max_results: int = 10, ) (`llmitm_v2/repository/graph_repository.py:451`)
- **get_repair_history**( self, fingerprint_hash: str, max_results: int = 10, ) (`llmitm_v2/tools/graph_tools.py:93`)
- **increment_execution_count**( self, action_graph_id: str, succeeded: bool, ) (`llmitm_v2/repository/graph_repository.py:423`)
- **must_be_concrete_path**(cls, v: str) (`llmitm_v2/models/recon.py:34`)
- **repair_step_chain**( self, action_graph_id: str, failed_step_order: int, new_steps: List[Step], ) (`llmitm_v2/repository/graph_repository.py:305`)
- **response**(self, flow: http.HTTPFlow) (`llmitm_v2/capture/addon.py:18`)
- **run**( self, fingerprint: Fingerprint, mitm_file: str = "", proxy_url: str = "", ) (`llmitm_v2/orchestrator/orchestrator.py:79`)
- **save_action_graph**( self, fingerprint_hash: str, action_graph: ActionGraph, ) (`llmitm_v2/repository/graph_repository.py:116`)
- **save_finding**( self, action_graph_id: str, finding: Finding, ) (`llmitm_v2/repository/graph_repository.py:265`)
- **save_fingerprint**(self, fingerprint: Fingerprint) (`llmitm_v2/repository/graph_repository.py:27`)
- **success_rate**(self) (`llmitm_v2/models/action_graph.py:41`)
- **execute**(self, step, context) (`tests/test_handlers.py:52`)
- **test_action_graph_creation**(self) (`tests/test_models.py:60`)
- **test_action_graph_id_generation**(self) (`tests/test_models.py:65`)
- **test_action_graph_json_round_trip**(self) (`tests/test_models.py:142`)
- **test_action_graph_success_rate**(self) (`tests/test_models.py:70`)
- **test_action_graph_success_rate_zero**(self) (`tests/test_models.py:74`)
- **test_action_graph_with_multiple_steps**(self, sample_action_graph) (`tests/test_graph_repository.py:61`)
- **test_assemble_recon_context_error_when_no_args**(self) (`tests/test_orchestrator.py:75`)
- **test_assemble_recon_context_file_mode**(self) (`tests/test_orchestrator.py:65`)
- **test_assemble_recon_context_live_mode**(self) (`tests/test_orchestrator.py:70`)
- **test_assemble_repair_context_includes_step_and_error**(self) (`tests/test_orchestrator.py:79`)
- **test_assemble_repair_context_truncates_error_log**(self) (`tests/test_orchestrator.py:87`)
- **test_classify_failure_401_is_unrecoverable**(self) (`tests/test_orchestrator.py:41`)
- **test_classify_failure_403_is_unrecoverable**(self) (`tests/test_orchestrator.py:45`)
- **test_classify_failure_404_is_systemic**(self) (`tests/test_orchestrator.py:37`)
- **test_classify_failure_429_is_recoverable**(self) (`tests/test_orchestrator.py:33`)
- **test_classify_failure_503_is_recoverable**(self) (`tests/test_orchestrator.py:29`)
- **test_classify_failure_reset_is_recoverable**(self) (`tests/test_orchestrator.py:57`)
- **test_classify_failure_session_expired_is_unrecoverable**(self) (`tests/test_orchestrator.py:49`)
- **test_classify_failure_timeout_is_recoverable**(self) (`tests/test_orchestrator.py:25`)
- **test_classify_failure_unknown_is_systemic**(self) (`tests/test_orchestrator.py:53`)
- **test_cold_start_path**(self) (`tests/test_orchestrator_main.py:63`)
- **test_create_attack_critic_returns_simple_agent**(self) (`tests/test_orchestrator.py:136`)
- **test_create_recon_agent_returns_programmatic_agent**(self) (`tests/test_orchestrator.py:130`)
- **test_creation**(self, sample_opportunity) (`tests/test_recon_models.py:29`)
- **test_creation**(self, sample_plan) (`tests/test_recon_models.py:52`)
- **test_critic_feedback_failed**(self) (`tests/test_models.py:99`)
- **test_critic_feedback_passed**(self) (`tests/test_models.py:95`)
- **test_defaults**(self) (`tests/test_orchestrator_main.py:50`)
- **test_empty_plan**(self) (`tests/test_recon_models.py:55`)
- **test_execution_context_creation**(self) (`tests/test_models.py:121`)
- **test_finding_creation**(self) (`tests/test_models.py:82`)
- **test_finding_id_generation**(self) (`tests/test_models.py:86`)
- **test_finding_severity_levels**(self) (`tests/test_graph_repository.py:67`)
- **test_fingerprint_hash_computation**(self) (`tests/test_models.py:36`)
- **test_fingerprint_hash_consistency**(self) (`tests/test_models.py:41`)
- **test_fingerprint_hash_differs_by_tech_stack**(self) (`tests/test_models.py:46`)
- **test_fingerprint_json_round_trip**(self) (`tests/test_models.py:148`)
- **test_fingerprint_security_signals**(self, sample_fingerprint) (`tests/test_graph_repository.py:64`)
- **test_fingerprint_with_embedding**(self) (`tests/test_models.py:51`)
- **test_graph_tools_init_accepts_repo**(self) (`tests/test_orchestrator.py:96`)
- **test_graph_tools_lazy_loads_embedding_model**(self) (`tests/test_orchestrator.py:110`)
- **test_increment_execution_count**(self, sample_fingerprint, sample_action_graph) (`tests/test_graph_repository.py:141`)
- **test_init_stores_dependencies**(self) (`tests/test_orchestrator_main.py:82`)
- **test_invalid_exploit_tool**(self) (`tests/test_recon_models.py:39`)
- **test_invalid_recon_tool**(self) (`tests/test_recon_models.py:32`)
- **test_load_skill_guides_includes_recon_tools**(self) (`tests/test_orchestrator.py:155`)
- **test_load_skill_guides_returns_string**(self) (`tests/test_orchestrator.py:150`)
- **test_multiple_opportunities**(self, sample_opportunity) (`tests/test_recon_models.py:63`)
- **test_negative_index**(self, fingerprint) (`tests/test_orchestrator_main.py:96`)
- **test_no_interpolation_needed**(self, fingerprint) (`tests/test_orchestrator_main.py:102`)
- **test_out_of_range_index_preserved**(self, fingerprint) (`tests/test_orchestrator_main.py:114`)
- **test_preserves_non_string_values**(self, fingerprint) (`tests/test_orchestrator_main.py:108`)
- **test_recon_agent_has_recon_tools**(self) (`tests/test_orchestrator.py:142`)
- **test_recursive_interpolation_nested_dict**(self, fingerprint) (`tests/test_orchestrator_main.py:120`)
- **test_recursive_interpolation_nested_list**(self, fingerprint) (`tests/test_orchestrator_main.py:127`)
- **test_repair_diagnosis_systemic**(self) (`tests/test_models.py:112`)
- **test_repair_diagnosis_transient**(self) (`tests/test_models.py:107`)
- **test_replaces_previous_output_reference**(self, fingerprint) (`tests/test_orchestrator_main.py:90`)
- **test_save_and_retrieve_action_graph**(self, sample_fingerprint, sample_action_graph) (`tests/test_graph_repository.py:98`)
- **test_save_and_retrieve_fingerprint**(self, sample_fingerprint) (`tests/test_graph_repository.py:77`)
- **test_save_finding**(self, sample_fingerprint, sample_action_graph, sample_finding) (`tests/test_graph_repository.py:120`)
- **test_serialization**(self, sample_opportunity) (`tests/test_recon_models.py:46`)
- **test_serialization**(self, sample_plan) (`tests/test_recon_models.py:59`)
- **test_step_creation**(self) (`tests/test_models.py:23`)
- **test_step_parameters_empty**(self) (`tests/test_graph_repository.py:52`)
- **test_step_parameters_json_serialization**(self) (`tests/test_graph_repository.py:47`)
- **test_step_result_failure**(self) (`tests/test_models.py:134`)
- **test_step_result_success**(self) (`tests/test_models.py:130`)
- **test_step_serialization**(self) (`tests/test_models.py:27`)
- **test_warm_start_path**(self) (`tests/test_orchestrator_main.py:67`)
- **test_with_error**(self) (`tests/test_orchestrator_main.py:54`)
- **test_with_execution_result**(self) (`tests/test_orchestrator_main.py:71`)
